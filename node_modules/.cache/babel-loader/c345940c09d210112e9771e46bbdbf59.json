{"ast":null,"code":"import _slicedToArray from \"C:\\\\Users\\\\PotapovDS\\\\AppData\\\\Roaming\\\\npm\\\\node_modules\\\\react-scripts\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"E:\\\\JS\\\\react_course\\\\4_connection\\\\src\\\\game.js\";\nimport React, { useState, useEffect } from 'react';\nimport './styles/App.css';\nimport Table from './components/table/table';\nimport { Redirect } from 'react-router-dom';\nimport axios from 'axios';\n\nfunction Game(props) {\n  const START_GAME = [[0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0], [0, 0, 0, 0, 0, 0]];\n  const player1Name = props.location.state.player1Name;\n  const player2Name = props.location.state.player2Name;\n\n  const _useState = useState(1),\n        _useState2 = _slicedToArray(_useState, 2),\n        currentPlayer = _useState2[0],\n        setCurrentPlayer = _useState2[1];\n\n  const _useState3 = useState(START_GAME),\n        _useState4 = _slicedToArray(_useState3, 2),\n        field = _useState4[0],\n        setField = _useState4[1];\n\n  const _useState5 = useState(false),\n        _useState6 = _slicedToArray(_useState5, 2),\n        isEndGame = _useState6[0],\n        setIsEndGame = _useState6[1];\n\n  useEffect(() => {\n    const intervalID = setInterval(axios.get('http://localhost:4000/game/status').then(response => {\n      console.log(response.data);\n      setField(response.data.field);\n      setCurrentPlayer(response.data.currentPlayer);\n    }).catch(error => console.log(error)), 2000);\n    return () => {\n      clearInterval(intervalID);\n    };\n  }, []); //проверяем заполнен ли ряд, если да, ход не засчитывается, перехода хода нет\n\n  function checkFullColumn(arr) {\n    if (arr.indexOf(0) === -1) {\n      alert('этот ряд заполнен');\n      return true;\n    }\n  } // сам ход\n\n\n  function move(columnId) {\n    columnId--;\n    let arr = field[columnId];\n    if (checkFullColumn(arr)) return;\n    let position = arr.indexOf(0);\n    arr[position] = currentPlayer; // здесь отправляем запрос на изменение состояния field на сервер\n\n    axios.post('http://localhost:4000/game', {\n      field: field,\n      currentPlayer: currentPlayer,\n      column: columnId,\n      raw: position\n    }).then(res => {\n      setField(res.data.field);\n      setCurrentPlayer(res.data.currentPlayer);\n      setIsEndGame(res.data.isEndGame);\n    }).catch(error => {\n      console.log(error);\n    });\n  } // проверка введено ли что-то в поля имен, можно добавить проверку по каждому из полей,\n  // если проверка не прошла возвра на стартовую сраницу\n\n\n  if (!props.location.state.player1Name || !props.location.state.player2Name) {\n    alert('Введите имя игрока');\n    return React.createElement(Redirect, {\n      to: \"/\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    });\n  } // если игра закончилась, направляем на конечный экран, передаем имена игроков и номер игрока-победиеля\n\n\n  if (isEndGame === true) {\n    return React.createElement(Redirect, {\n      to: {\n        pathname: '/endGame',\n        state: {\n          currentPlayer: currentPlayer,\n          player1Name: player1Name,\n          player2Name: player2Name\n        }\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 86\n      },\n      __self: this\n    });\n  }\n\n  return React.createElement(\"div\", {\n    className: \"App\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, player1Name), \"vs\", React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, player2Name), React.createElement(Table, {\n    onColumnPress: move,\n    currentPlayer: currentPlayer,\n    player1Name: player1Name,\n    player2Name: player2Name,\n    field: field,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }));\n}\n\nexport default Game;","map":{"version":3,"sources":["E:/JS/react_course/4_connection/src/game.js"],"names":["React","useState","useEffect","Table","Redirect","axios","Game","props","START_GAME","player1Name","location","state","player2Name","currentPlayer","setCurrentPlayer","field","setField","isEndGame","setIsEndGame","intervalID","setInterval","get","then","response","console","log","data","catch","error","clearInterval","checkFullColumn","arr","indexOf","alert","move","columnId","position","post","column","raw","res","pathname"],"mappings":"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","sourcesContent":["import React, {useState, useEffect} from 'react';\r\nimport './styles/App.css';\r\nimport Table from './components/table/table';\r\nimport {Redirect} from 'react-router-dom';\r\nimport axios from 'axios';\r\n\r\nfunction Game(props) {\r\n\r\n  const START_GAME = [\r\n    [0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0],\r\n    [0, 0, 0, 0, 0, 0],\r\n  ]\r\n\r\n  const player1Name = props.location.state.player1Name;\r\n  const player2Name = props.location.state.player2Name;\r\n\r\n  const [currentPlayer, setCurrentPlayer] = useState(1);\r\n  const [field, setField] = useState(START_GAME);\r\n  const [isEndGame, setIsEndGame] = useState(false);\r\n\r\n  useEffect(() => {\r\n      const intervalID = setInterval(\r\n        axios.get('http://localhost:4000/game/status')\r\n        .then((response) => {\r\n          console.log(response.data);\r\n          setField(response.data.field);\r\n          setCurrentPlayer(response.data.currentPlayer);\r\n        })\r\n        .catch((error) => console.log(error)),\r\n        2000\r\n      );\r\n      return () => {\r\n        clearInterval(intervalID);\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  //проверяем заполнен ли ряд, если да, ход не засчитывается, перехода хода нет\r\n  function checkFullColumn(arr) {\r\n    if (arr.indexOf(0) === -1) {\r\n      alert('этот ряд заполнен');\r\n      return true;\r\n    }\r\n  }\r\n\r\n  // сам ход\r\n  function move(columnId) {\r\n    columnId--;\r\n    let arr = field[columnId];\r\n    if (checkFullColumn(arr)) return;\r\n    let position = arr.indexOf(0);\r\n\r\n    arr[position] = currentPlayer;\r\n\r\n// здесь отправляем запрос на изменение состояния field на сервер\r\n    axios\r\n      .post(\r\n        'http://localhost:4000/game',\r\n        {field: field, currentPlayer: currentPlayer, column: columnId, raw: position }\r\n      )\r\n      .then((res)=> {\r\n        setField(res.data.field);\r\n        setCurrentPlayer(res.data.currentPlayer);\r\n        setIsEndGame(res.data.isEndGame);\r\n      })\r\n      .catch((error)=> {\r\n        console.log(error);\r\n      });\r\n  }\r\n\r\n  // проверка введено ли что-то в поля имен, можно добавить проверку по каждому из полей,\r\n  // если проверка не прошла возвра на стартовую сраницу\r\n  if (!props.location.state.player1Name || !props.location.state.player2Name) {\r\n    alert('Введите имя игрока');\r\n    return <Redirect to=\"/\" / >\r\n  }\r\n\r\n  // если игра закончилась, направляем на конечный экран, передаем имена игроков и номер игрока-победиеля\r\n  if (isEndGame === true) {\r\n    return <Redirect to={\r\n      {\r\n        pathname: '/endGame',\r\n        state: {\r\n          currentPlayer: currentPlayer,\r\n          player1Name: player1Name,\r\n          player2Name: player2Name\r\n        }\r\n      }\r\n    }\r\n    />\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <p>{player1Name}</p>\r\n      vs\r\n      <p>{player2Name}</p>\r\n      <Table onColumnPress={move}\r\n             currentPlayer={currentPlayer}\r\n             player1Name={player1Name}\r\n             player2Name={player2Name}\r\n             field={field}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Game;\r\n"]},"metadata":{},"sourceType":"module"}